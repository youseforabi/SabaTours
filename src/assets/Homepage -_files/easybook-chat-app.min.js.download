!function(){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(r=function(){return!!e})()}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function a(){return function(e,t){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),e=this,n=arguments,t=o(t=a),function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,r()?Reflect.construct(t,n||[],o(e).constructor):t.apply(e,n));var e,t,n}var t;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)}(a,React.Component),function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,"symbol"==i(o=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=i(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(r))?o:String(o)),a)}var r,o}((t=a).prototype,[{key:"_checkActiveContact",value:function(e){return e==this.props.activeContact?"contact-item active":"contact-item"}},{key:"render",value:function(){var t=this,n=this.props.item;return React.createElement("a",{className:this._checkActiveContact(n.cid),href:"#",onClick:function(e){return t.props.changeContact(n,e)}},React.createElement("div",{className:"contact-avatar"},React.createElement("img",{alt:n.display_name,className:"avatar avatar-150 photo",height:"150",width:"150",src:n.avatar_url})),React.createElement("div",{className:"contact-content"},React.createElement("h4",{className:"display_name"},n.display_name),React.createElement("span",{className:"contact-date"},n.date),null!=n.reply&&-1===n.reply.indexOf("LCARD")&&React.createElement("div",{className:"contact-reply-text",dangerouslySetInnerHTML:{__html:n.reply.replace(/\n/g,"<br />")}})))}}]),Object.defineProperty(t,"prototype",{writable:!1}),a}();function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(s=function(){return!!e})()}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){function a(){return function(e,t){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),e=this,n=arguments,t=u(t=a),function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,s()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n));var e,t,n}var t;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(a,React.Component),function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,"symbol"==l(o=function(e,t){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=l(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(r))?o:String(o)),a)}var r,o}((t=a).prototype,[{key:"_replyClasses",value:function(e){var t="chat-reply chat-reply-".concat(e.crid);return e.uid!=e.user_one&&(t+=" chat-reply-reply"),e.uid==e.current_user&&(t+=" your-reply"),t}},{key:"render",value:function(){var e=this.props.item,t=!1,n={},a=e.reply;if(0===a.indexOf("LCARD")){t=!0,a=decodeURIComponent(a.substr(5));try{n=JSON.parse(a)}catch(e){console.log(e)}}return t&&null!=n.title?React.createElement("div",{className:this._replyClasses(e)},React.createElement("div",{className:"reply-card-inner"},React.createElement("img",{alt:e.display_name,className:"reply-card-thumbnail",height:"150",width:"150",src:n.thumbnail}),React.createElement("div",{className:"reply-card-details"},React.createElement("div",{className:"reply-card-text",dangerouslySetInnerHTML:{__html:n.title}})))):React.createElement("div",{className:this._replyClasses(e)},React.createElement("div",{className:"reply-avatar"},React.createElement("img",{alt:e.display_name,className:"avatar avatar-150 photo",height:"150",width:"150",src:e.avatar_url}),React.createElement("span",{className:"display_name"},e.display_name)),React.createElement("div",{className:"reply-content"},React.createElement("span",{className:"reply-time",dangerouslySetInnerHTML:{__html:e.time}}),null!=e.reply?React.createElement("div",{className:"reply-text",dangerouslySetInnerHTML:{__html:e.reply.replace(/\n/g,"<br />")}}):null))}}]),Object.defineProperty(t,"prototype",{writable:!1}),a}();function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(f=function(){return!!e})()}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function o(e){var t,n,a,r;return function(e,t){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(n=this,a=o,r=[e],a=h(a),t=function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}(n,f()?Reflect.construct(a,r||[],h(n).constructor):a.apply(n,r))).props.chats,t.state={isLoggedIn:!1,reply_text:"",inputFocus:!1},t.scrollAtBottom=!0,t.top_loading=!1,t.timeout=null,t.handleChange=t.handleChange.bind(m(t)),t.handleSubmit=t.handleSubmit.bind(m(t)),t.changeContact=t.changeContact.bind(m(t)),t.onRepliesListScroll=t.onRepliesListScroll.bind(m(t)),t.inputFocus=t.inputFocus.bind(m(t)),t.inputBlur=t.inputBlur.bind(m(t)),t}var t;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(o,React.Component),function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,"symbol"==p(o=function(e,t){if("object"!=p(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=p(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(r))?o:String(o)),a)}var r,o}((t=o).prototype,[{key:"componentDidMount",value:function(){var e=this.props.chats;_easybook_add_ons.curr_user.id&&(this.setState({isLoggedIn:!0}),0==e.firstLoaded&&this.props.getContacts(),this.getRepliesTimeoutFunction())}},{key:"getRepliesTimeoutFunction",value:function(){var e=this;this.props.getReplies(this.props.chats.active,this.props.chats.lastRID);var t=6e4,n=this.props.chats;5<n.noReplyNum&&(t*=5),10<n.noReplyNum&&(t*=10),20<n.noReplyNum&&(t*=20),this.timeout=setTimeout(function(){e.getRepliesTimeoutFunction()},t)}},{key:"getSnapshotBeforeUpdate",value:function(e,t){if(this.historyChanged=e.chats.replies.length!==this.props.chats.replies.length,this.historyChanged){var n=this.refs.repliesList;if(null==n)return null;var a=n.scrollTop,r=n.scrollHeight-n.clientHeight;if(this.scrollAtBottom=r<=0||r-200<=a,!this.scrollAtBottom&&a<150){var o=n.childNodes.length;this.topReply=0===o?null:n.childNodes[0]}else this.topReply=null}return null}},{key:"componentDidUpdate",value:function(){if(this.historyChanged){this.scrollAtBottom&&this.scrollToBottom(),null!=this.topReply&&ReactDOM.findDOMNode(this.topReply).scrollIntoView();var e=this.props.chats,n=0,a=0;e.replies.map(function(e,t){0===t&&(n=e.crid),a=e.crid}),this.props.updateFirstLastRID(n,a),this.top_loading=!1}}},{key:"componentWillUnmount",value:function(){null!=this.timeout&&clearTimeout(this.timeout)}},{key:"handleChange",value:function(e){e.preventDefault(),this.setState({reply_text:e.target.value})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.chatReply(this.props.chats.active,_easybook_add_ons.curr_user.id,this.props.chats.touid,this.state.reply_text),this.setState({reply_text:""})}},{key:"changeContact",value:function(e,t){t.preventDefault(),e.cid!=this.props.chats.active&&(this.props.changeContact(e),this.props.getReplies(e.cid,!1))}},{key:"onRepliesListScroll",value:function(){if(null!=this.refs.repliesList){var e=this.props.chats,t=this.refs.repliesList.scrollTop;e.firstRemain&&!1===this.top_loading&&0===t&&(this.top_loading=!0,this.props.getMoreTopReplies(e.active,e.firstRID))}}},{key:"scrollToBottom",value:function(){var e=this.refs.repliesList;if(null!=e){var t=e.scrollHeight-e.clientHeight;null!=this.state.inputFocus&&this.state.inputFocus&&(t+=50),ReactDOM.findDOMNode(e).scrollTop=0<t?t:0}}},{key:"inputFocus",value:function(){var e=this;this.setState({inputFocus:!0}),setTimeout(function(){e.scrollToBottom()},100)}},{key:"inputBlur",value:function(){this.setState({inputFocus:!1})}},{key:"render",value:function(){var n=this;return this.props.chats,React.createElement("section",{className:"middle-padding"},React.createElement("div",{className:"container dashboard-container"},React.createElement("div",{className:"dasboard-wrap fl-wrap"},React.createElement("div",{className:"dashboard-content fl-wrap"},React.createElement("div",{className:"dashboard-list-box fl-wrap"},React.createElement("div",{className:"dashboard-header fl-wrap"},React.createElement("h3",null,_easybook_dashboard.i18n.chats_h3)),React.createElement("div",{id:"chat-wrapper",className:"row"},React.createElement("div",{className:"col-sm-8 chat-box-wrap"},React.createElement("div",{id:"chat-box",className:"chat-box fl-wrap grey-blue-bg loading-repliess",ref:"repliesList",onScroll:this.onRepliesListScroll},this.props.chats.replies.map(function(e,t){return React.createElement(a,{key:e.crid,item:e})}),this.state.inputFocus&&React.createElement("div",{className:"chat-replies-loading"},React.createElement("span",null),React.createElement("span",null),React.createElement("span",null))),React.createElement("div",{id:"chat-input-wrap",className:"message-input fl-wrap"},React.createElement("form",{onSubmit:this.handleSubmit},React.createElement("textarea",{placeholder:_easybook_add_ons.i18n.chat_type_msg,required:!0,value:this.state.reply_text,onFocus:this.inputFocus,onBlur:this.inputBlur,onChange:this.handleChange}),React.createElement("button",{type:"submit"},React.createElement("i",{className:"fal fa-paper-plane"}))))),React.createElement("div",{id:"chat-contacts",className:"col-sm-4 chat-contacts-wrap"},React.createElement("div",{className:"chat-contacts fl-wrap"},this.props.chats.contacts.map(function(e,t){return React.createElement(c,{key:e.cid,item:e,activeContact:n.props.chats.active,changeContact:n.changeContact})})))))))))}}]),Object.defineProperty(t,"prototype",{writable:!1}),o}(),b="GET_CONTACTS_SUCCESS",_="GET_REPLIES_SUCCESS",g="GET_MORE_TOP_REPLIES_SUCCESS",k="CHANGE_CONTACT_SUCCESS",R="REPLY_SUCCESS",E="UPDATE_FIRST_LAST_RID_SUCCESS",w="RESET_CHATS_STATE_SUCCESS";function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(C=function(){return!!e})()}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return(j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var e=ReactRedux.connect,t=function(e){function o(e){var t,n,a,r;return function(e,t){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(n=this,a=o,r=[e],a=S(a),t=function(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return N(e)}(n,C()?Reflect.construct(a,r||[],S(n).constructor):a.apply(n,r))).state={isLoggedIn:!1,reply_text:"",showContact:!0,showChatBox:!1,inputFocus:!1},t.showContact=t.showContact.bind(N(t)),t.toggleChatBox=t.toggleChatBox.bind(N(t)),t.inputFocus=t.inputFocus.bind(N(t)),t.inputBlur=t.inputBlur.bind(N(t)),t}var t;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(o,v),function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,"symbol"==O(o=function(e,t){if("object"!=O(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=O(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(r))?o:String(o)),a)}var r,o}((t=o).prototype,[{key:"componentDidMount",value:function(){var e=this.props.chats;_easybook_add_ons.curr_user.id&&(this.setState({isLoggedIn:!0}),0==e.firstLoaded&&this.props.getContacts())}},{key:"showContact",value:function(){null!=this.timeout&&clearTimeout(this.timeout),this.setState({showContact:!0})}},{key:"changeContact",value:function(e,t){v.prototype.changeContact.call(this,e,t),this.setState({showContact:!1}),this.getRepliesTimeoutFunction()}},{key:"_renderContacts",value:function(n){var a=this;return this.state.showContact&&React.createElement("div",{className:"chat-contacts-wrap"},React.createElement("div",{className:"chat-contacts fl-wrap"},n.contacts.map(function(e,t){return React.createElement(c,{key:e.cid,item:e,activeContact:n.active,changeContact:a.changeContact})})))}},{key:"inputFocus",value:function(){var e=this;this.setState({inputFocus:!0}),setTimeout(function(){e.scrollToBottom()},100)}},{key:"inputBlur",value:function(){this.setState({inputFocus:!1})}},{key:"_renderReplies",value:function(e){return 1!=this.state.showContact&&React.createElement("div",{className:"wrap-chat-box"},React.createElement("div",{className:"chat-box fl-wrap grey-blue-bg loading-repliess",ref:"repliesList",onScroll:this.onRepliesListScroll},e.replies.map(function(e,t){return React.createElement(a,{key:t,item:e})}),this.state.inputFocus&&React.createElement("div",{className:"chat-replies-loading"},React.createElement("span",null),React.createElement("span",null),React.createElement("span",null))),React.createElement("div",{id:"chat-input-wrap",className:"message-input fl-wrap"},React.createElement("form",{onSubmit:this.handleSubmit},React.createElement("textarea",{placeholder:_easybook_add_ons.i18n.chat_type_msg,required:!0,value:this.state.reply_text,onFocus:this.inputFocus,onBlur:this.inputBlur,onChange:this.handleChange}),React.createElement("button",{type:"submit"},React.createElement("i",{className:"fal fa-paper-plane"})))))}},{key:"_renderToggleButton",value:function(){return this.state.isLoggedIn?React.createElement("div",{className:"chat-widget-button",onClick:this.toggleChatBox},React.createElement("i",{className:"fa fa-comments"}),React.createElement("span",null,_easybook_add_ons.i18n.chat_fr_owner)):React.createElement("div",{className:"chat-widget-button logreg-modal-open"},React.createElement("i",{className:"fa fa-comments"}),React.createElement("span",null,_easybook_add_ons.i18n.chat_fr_login))}},{key:"toggleChatBox",value:function(){this.setState({showChatBox:!this.state.showChatBox})}},{key:"render",value:function(){var e="",t=this.props.chats;if(null!=t&&null!=t.touid&&Array.isArray(t.contacts)&&t.contacts.length){var n=t.contacts.find(function(e){return e.uid==t.touid});n&&(e=n.display_name)}var a="chat-widget_wrap";return 1==this.state.showChatBox&&(a+=" show"),React.createElement("div",null,this._renderToggleButton(),React.createElement("div",{className:a},React.createElement("div",null,React.createElement("div",{className:"chat-widget_header color-bg"},React.createElement("div",{className:"chats-title"},this.state.showContact?React.createElement("h3",{className:"tit-hidden"},_easybook_add_ons.i18n.chat_fr_conver):React.createElement("div",null,React.createElement("a",{className:"back-to-list",onClick:this.showContact},React.createElement("i",{className:"fa fa-chevron-left"})),React.createElement("h3",{className:"title-chats"},_easybook_add_ons.i18n.chat_fr_cwith,React.createElement("a",{href:"#"}," ",e)))),React.createElement("div",{className:"chats-desc"},""!=_easybook_add_ons.chatbox_message&&React.createElement("div",{className:"chatbox-desc",dangerouslySetInnerHTML:{__html:_easybook_add_ons.chatbox_message}}),React.createElement("svg",{viewBox:"0 0 500 120",preserveAspectRatio:"none"},React.createElement("path",{d:"M0,50 C200,95 320, 12 500,65 L500,200 L00,200 Z"})))),this._renderContacts(t),this._renderReplies(t))))}}]),Object.defineProperty(t,"prototype",{writable:!1}),o}(),D=e(function(e){return{chats:e.chats}},function(l){return{getContacts:function(){return l(function(n){var e={action:"easybook_addons_chat_contacts",_nonce:_easybook_add_ons.nonce,for:_easybook_add_ons.curr_user.id};return axios.post(_easybook_add_ons.url,Qs.stringify(e)).then(function(e){var t;e.data.success&&n((t=e.data.chat,{type:b,chat:t,firstLoaded:void 0}))}).catch(function(e){console.log(e)})})},changeContact:function(e){return l((t=e,function(e){e({type:k,contact:t})}));var t},getReplies:function(e,t){return l((a=e,r=t,function(n){var e={action:"easybook_addons_chat_replies",_nonce:_easybook_add_ons.nonce,cid:a};return r&&(e.lastRID=r),axios.post(_easybook_add_ons.url,Qs.stringify(e)).then(function(e){var t;e.data.success&&n((t=e.data.replies,{type:_,replies:t,lastRID:r}))}).catch(function(e){console.log(e)})}));var a,r},chatReply:function(e,t,n,a){return l((r=e,o=t,i=n,c=a,function(n){var e={action:"easybook_addons_chat_reply",_nonce:_easybook_add_ons.nonce,cid:r,user_id:o,touid:i,reply_text:c};return axios.post(_easybook_add_ons.url,Qs.stringify(e)).then(function(e){var t;e.data.success&&n((t=e.data.reply,{type:R,reply:t}))}).catch(function(e){console.log(e)})}));var r,o,i,c},updateFirstLastRID:function(e,t){return l((n=e,a=t,function(e){e({type:E,firstRID:n,lastRID:a})}));var n,a},getMoreTopReplies:function(e,t){return l((a=e,r=t,function(n){var e={action:"easybook_addons_chat_replies",_nonce:_easybook_add_ons.nonce,cid:a,firstRID:r};return axios.post(_easybook_add_ons.url,Qs.stringify(e)).then(function(e){var t;e.data.success&&n((t=e.data.replies,{type:g,replies:t}))}).catch(function(e){console.log(e)})}));var a,r},resetChatsState:function(){return l({type:w})}}})(t),q="CHECK_AVAILABILITY_START",P="CHECK_AVAILABILITY_SUCCESS";function T(t){return function(n){var e={action:"check_availability",_wpnonce:_easybook_add_ons.nonce,listing_id:_easybook_add_ons.post_id};return e=Object.assign({},t,e),n({type:q}),axios.post(_easybook_add_ons.url,Qs.stringify(e)).then(function(e){var t;null!=e.data.debug&&1==e.data.debug&&console.log(e.data),e.data.success&&n((t=e.data,{type:P,data:t}))}).catch(function(e){console.log(e)})}}function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(I=function(){return!!e})()}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e,t){return(F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Q=function(e){function c(e){var t;!function(e,t){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this);var n,a,r,o=(n=this,a=c,r=[e],a=x(a),t=function(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return M(e)}(n,I()?Reflect.construct(a,r||[],x(n).constructor):a.apply(n,r))).props.room;t.state={qtt:o.qtt};var i=5;return parseInt(o.quantities)<i&&(i=parseInt(o.quantities)),t.max_qtt=i,t.onChangeQtt=t.onChangeQtt.bind(M(t)),t.onClickQtt=t.onClickQtt.bind(M(t)),t}var t;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(c,React.Component),function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,"symbol"==A(o=function(e,t){if("object"!=A(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=A(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(r))?o:String(o)),a)}var r,o}((t=c).prototype,[{key:"onChangeQtt",value:function(e){this.handleQttChange(e.target.value)}},{key:"handleQttChange",value:function(e){var t=this.props.room,n=t.id,a=t.available;0<=e&&(this.setState({qtt:e}),a&&this.props.changeRoomQtt(e,n,this.props.room))}},{key:"onClickQtt",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"up",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e3,a=this.state.qtt;"down"==e&&t<a?--a:"up"==e&&a<n&&++a,this.handleQttChange(a)}},{key:"render",value:function(){var t=this,e=(this.props.room,this.props.room),n=(e.id,e.adults),a=e.children,r=e.title,o=e.quantities,i=e.available,c=(e.price,e.children_price,parseInt(n),parseInt(a),this.props.rOrder);return React.createElement("div",{className:"multiqtts-select_item bkroom-item"},React.createElement("div",{className:null!=c&&1===c?"multiqtts-select_header vis-multiqtt_select fl-wrap":"multiqtts-select_header fl-wrap"},r,React.createElement("span",{className:"available_counter green-bg"},o),React.createElement("i",{className:"fal fa-plus"})),i&&React.createElement("div",{className:null!=c&&1===c?"custom-tour-quantities multiqtts-select_content vis-multiqtt_select_cont":"custom-tour-quantities multiqtts-select_content"},React.createElement("div",{className:"qtt-item qtt-item-full"},React.createElement("div",{className:"qtt-label-wrap"},_easybook_add_ons.i18n.roomsl_quan),React.createElement("div",{className:"qtt-input"},React.createElement("input",{type:"number",className:"tour-quantity-input",min:"0",step:"1",max:this.max_qtt,value:this.state.qtt,readOnly:!0,onChange:this.onChangeQtt}),React.createElement("div",{className:"qtt-nav"},React.createElement("div",{className:"qtt-btn qtt-up",onClick:function(e){return t.onClickQtt("up",0,t.max_qtt)}},"+"),React.createElement("div",{className:"qtt-btn qtt-down",onClick:function(e){return t.onClickQtt("down",0,t.max_qtt)}},"-"))))))}}]),Object.defineProperty(t,"prototype",{writable:!1}),c}();function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,void 0,"symbol"==B(o=function(e,t){if("object"!=B(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=B(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(r))?o:String(o)),a)}var r,o}function H(e,t,n){return t&&Y(e.prototype,t),n&&Y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function U(e,t,n){return t=W(t),function(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $(e)}(e,V()?Reflect.construct(t,n||[],W(e).constructor):t.apply(e,n))}function V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(V=function(){return!!e})()}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}function K(e,t){return(K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var J=function(e){function c(e){var t;L(this,c),(t=U(this,c,[e])).fieldName="";var n=t.props,a=n.fieldName,r=n.fieldValue,o=n.field;null!=a&&(t.fieldName=a);var i=t.parseFieldValue(r);return t.state={vals:i,current:0,show_selector:!1},t.options={showing:1,max:12},t.format="YYYY-MM-DD",null!=o&&null!=o.format&&""!=o.format&&(t.format=o.format),t.wrapperRef=null,t.toggleDate=t.toggleDate.bind($(t)),t.switchMonth=t.switchMonth.bind($(t)),t.onFocusInput=t.onFocusInput.bind($(t)),t.setWrapperRef=t.setWrapperRef.bind($(t)),t.handleClickOutside=t.handleClickOutside.bind($(t)),t.onClickApply=t.onClickApply.bind($(t)),t.onClickCancel=t.onClickCancel.bind($(t)),t}return G(c,React.Component),H(c,[{key:"setWrapperRef",value:function(e){this.wrapperRef=e}},{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside,!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside,!0)}},{key:"handleClickOutside",value:function(e){1==this.state.show_selector&&this.wrapperRef&&0==this.wrapperRef.contains(e.target)&&this.setState({show_selector:!1})}},{key:"parseFieldValue",value:function(e){var t=[];if(null!=e&&Array.isArray(e)&&2==e.length){var n=/-/gm;t=[e[0].replace(n,""),e[1].replace(n,"")]}return(t=t.filter(function(e,t,n){return n.indexOf(e)===t})).length<2&&(t=[]),t}},{key:"onFocusInput",value:function(e){this.setState({show_selector:!0})}},{key:"onClickCancel",value:function(){this.setState({vals:[],show_selector:!1}),this.props.getCheckInOut(["",""])}},{key:"onClickApply",value:function(){this.setState({show_selector:!1})}},{key:"switchMonth",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"next",t=this.options.max,n=this.state.current;"next"==e?n<t&&++n:0<n&&--n,this.setState({current:n})}},{key:"toggleDate",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=this.state.vals;Array.isArray(n)&&(2<=n.length?n=[e]:1==n.length?t?n=[e]:n[0]<=e?n.push(e):n=[e]:n=[e],2==n.length?(this.props.getCheckInOut([this._formatOutDate(n[0]),this._formatOutDate(n[1])]),this.setState({show_selector:!1})):this.setState({vals:n}))}},{key:"_fieldClass",value:function(){var e="submit-field",t=this.state,n=t.vals,a=t.show_selector;return 2==n.length&&(e+=" ckinout-has-value"),1==a&&(e+=" show-selector"),e}},{key:"_renderFieldHeader",value:function(){var e=this.props.field;return React.createElement("div",{className:"lfield-header"},""!=e.icon&&React.createElement("span",{className:"lfield-icon"},React.createElement("i",{className:e.icon})),""!=e.label&&React.createElement("label",{className:"lfield-label",onClick:this.onFocusInput},e.label))}},{key:"_getMonthDatas",value:function(e){var t=this.state.vals;null!=e&&"function"==typeof e.getMonth||(e=new Date);var n=new Date,a=e.getFullYear(),r=e.getMonth(),o=this._getMonthNum(r),i=new Date(a,r,1),c=new Date(a,r+1,0),l=i.getDay(),s=c.getDate();n=new Date(n.getFullYear(),n.getMonth(),n.getDate());var u=[];if(0!==l)for(var d=0;d<l;d++)u.push({iso_date:"2018-12-16",date:0,status:"prev",time:"",selected:!1,first:!1,last:!1,inside:!1});for(var p=1;p<=s;p++){var f=new Date(a,r,p),h=this._getDateNum(p),m="".concat(a).concat(o).concat(h),y="".concat(a,"-").concat(o,"-").concat(h),v=!1,b=!1,_=!1,g=!1;2==t.length?(m==t[0]&&(b=v=!0),m==t[1]&&(_=v=!0),t[0]<m&&m<t[1]&&(g=!0)):1==t.length&&m==t[0]&&(b=v=!0);var k={iso_date:y,date:p,status:f<n?"past":"available",time:m,selected:v,first:b,last:_,inside:g};if(1===t.length&&null!=this.props.min_nights&&"available"==k.status){var R=parseInt(t[0]),E=parseInt(m),w=parseInt(this.props.min_nights);isNaN(R)||isNaN(E)||isNaN(w)||R<E&&this._getNightsDiff(E,R)<w&&(k.status="unavailable")}u.push(k)}return u}},{key:"_getMonthNum",value:function(e){return(e=parseInt(e)+1)<10?"0"+e:e}},{key:"_getDateNum",value:function(e){return e<10?"0"+e:e}},{key:"_renderDays",value:function(){var n=[];return _easybook_add_ons.i18n.days.forEach(function(e,t){return n.push(React.createElement(z,{key:t,day:e}))}),React.createElement("div",{className:"cal-days"},n)}},{key:"_getMonthString",value:function(e){null!=e&&"function"==typeof e.getMonth||(e=new Date);var t=e.getFullYear(),n=e.getMonth();return"".concat(t," ").concat(_easybook_add_ons.i18n.months[n])}},{key:"_formatOutDate",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"20181216",t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n="",a="",r="";return null!=(e=String(e))&&8==e.length?(n=e.substr(0,4),a=e.substr(4,2),r=e.substr(6,2),1==t?"".concat(n,"-").concat(a,"-").concat(r):this.format.replace("YYYY",n).replace("MM",a).replace("DD",r)):""}},{key:"_renderStringValue",value:function(){var e=this.state.vals,t="";return 2==e.length&&(t+=this._formatOutDate(e[0],!1),t+=" -> ",t+=this._formatOutDate(e[1],!1)),t}},{key:"_getDatesDiff",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.state.vals,n=0;if(2==t.length){var a=new Date(this._formatOutDate(t[0])),r=new Date(this._formatOutDate(t[1]));n=Math.floor((r-a)/864e5),1==e&&++n}return n}},{key:"_getNightsDiff",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a=0,r=new Date(this._formatOutDate(e,!0)),o=new Date(this._formatOutDate(t,!0));return a=Math.floor((r-o)/864e5),1==n&&++a,a}},{key:"_renderMonthFooter",value:function(){return this.state.vals.length,React.createElement("div",{className:"cal-months-footer"},React.createElement("span",{className:"selected-date"},this._renderStringValue()),React.createElement("button",{className:"btn-cal-cancel",type:"button",onClick:this.onClickCancel},_easybook_add_ons.i18n.checkout_can))}},{key:"_renderSelector",value:function(){var i=this,e=this.options,t=e.showing,n=e.max,c=this.state.current,a="cal-month-nav month-next",r="cal-month-nav month-prev";c<=0&&(r+=" month-disabled"),n<=c&&(a+=" month-disabled");for(var o=React.createElement("article",{className:"cal-months-header"},React.createElement("div",{className:r,onClick:function(e){return i.switchMonth("prev")}},React.createElement("span",null)),React.createElement("div",{className:a,onClick:function(e){return i.switchMonth("next")}},React.createElement("span",null))),l=[],s=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),a=new Date(t,n+c+u,1),r=i._getMonthDatas(a),o=[];r.forEach(function(e,t){return o.push(React.createElement(Z,{key:t,date:e,toggleDate:i.toggleDate}))}),l.push(React.createElement("div",{key:u,className:"cal-month"},React.createElement("div",{className:"cal-month-header"},React.createElement("div",{className:"cal-month-string"},i._getMonthString(a))),React.createElement("div",{className:"cal-dates-wrap"},i._renderDays(),React.createElement("div",{className:"cal-dates"},o))))},u=0;u<t;u++)s();var d="cal-months-wrap months-".concat(this.options.showing);return React.createElement("div",{className:"lfield-content checkinout-field"},React.createElement("div",{className:d},o,l,this._renderMonthFooter()))}},{key:"render",value:function(){var e=this.options;return e.showing,e.max,this.state.current,React.createElement("div",{className:this._fieldClass(),ref:this.setWrapperRef},null!=this.props.field&&this._renderFieldHeader(),React.createElement("input",{type:"text",className:"in-out-dates",value:this._renderStringValue(),readOnly:!0,onFocus:this.onFocusInput}),React.createElement("div",{className:"in-out-count"},React.createElement("i",{className:"fa fa-question-circle"}),React.createElement("span",null,_easybook_add_ons.i18n.nights," : ",React.createElement("strong",null,this._getDatesDiff(!1)))),1==this.state.show_selector&&this._renderSelector())}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.vals,a=e.fieldValue;if(2===a.length){var r=a[0].replace(/-/gm,""),o=a[1].replace(/-/gm,"");if(2===n.length&&(r!=n[0]||o!=n[1]))return{vals:[r,o]};if(0===n.length&&""!=r&&""!=o)return{vals:[r,o]}}return null}}]),c}(),Z=function(e){function n(e){var t;return L(this,n),(t=U(this,n,[e])).onToggle=t.onToggle.bind($(t)),t}return G(n,React.Component),H(n,[{key:"onToggle",value:function(e){var t=this.props.date,n=t.time,a=t.status,r=t.selected;"available"===a&&this.props.toggleDate(n,r)}},{key:"render",value:function(){var e=this.props.date,t=e.status,n=e.date,a="cal-date";return a+="prev"===t?" cal-date-diff":"past"===t?" cal-date-past":"unavailable"===t?" cal-date-unavailable":" cal-date-available",e.selected&&(a+=" cal-date-checked"),e.first&&(a+=" cal-date-cfirst"),e.last&&(a+=" cal-date-clast"),e.inside&&(a+=" cal-date-inside"),React.createElement("div",{className:a,onClick:this.onToggle},"prev"!=t&&React.createElement("span",null,n))}}]),n}(),z=function(e){function t(){return L(this,t),U(this,t,arguments)}return G(t,React.Component),H(t,[{key:"render",value:function(){var e=this.props.day;return React.createElement("div",{className:"cal-day"},e)}}]),t}();function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ee=function(){return!!e})()}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e,t){return(ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ae=function(e){function a(){return function(e,t){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),e=this,n=arguments,t=te(t=a),function(e,t){if(t&&("object"===X(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ee()?Reflect.construct(t,n||[],te(e).constructor):t.apply(e,n));var e,t,n}var t;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}(a,React.Component),function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,"symbol"==X(o=function(e,t){if("object"!=X(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=X(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(r))?o:String(o)),a)}var r,o}((t=a).prototype,[{key:"render",value:function(){var e="loading-indicator";return null!=this.props.class&&(e+=" "+this.props.class),React.createElement("div",{className:e},React.createElement("span",null),React.createElement("span",null),React.createElement("span",null))}}]),Object.defineProperty(t,"prototype",{writable:!1}),a}();function re(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"YYYY-MM-DD";"function"!=typeof(e=null==e||""==e?new Date:new Date(e)).getMonth&&(e=new Date);var a=e.getDate();null==t||isNaN(parseInt(t))||(a+=parseInt(t),e.setDate(a)),a=e.getDate();var r,o=e.getFullYear(),i=(r=e.getMonth(),(r=parseInt(r)+1)<10?"0"+r:r),c=a<10?"0"+a:a;return""!=n?n.replace(/YYYY/g,o).replace(/MM/g,i).replace(/DD/g,c):e.toString()}function oe(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(e=ie(e),null!=_easybook_add_ons.currency){e=parseFloat(e)*parseFloat(_easybook_add_ons.currency.rate);var n=parseInt(_easybook_add_ons.currency.decimal);if(0<n){var a=new RegExp("."==_easybook_add_ons.currency.dec_sep?"(\\d)(?=(\\d{3})+\\.)":"(\\d)(?=(\\d{3})+".concat(_easybook_add_ons.currency.dec_sep,")"),"g");e=e.toFixed(n).replace(".",_easybook_add_ons.currency.dec_sep).replace(a,"$1"+_easybook_add_ons.currency.ths_sep)}else e=(parseInt(e)+"").replace(/(\d)(?=(\d{3})+$)/g,"$1"+_easybook_add_ons.currency.ths_sep);t&&("left"==_easybook_add_ons.currency.sb_pos?e=_easybook_add_ons.currency.symbol+e:"left_space"==_easybook_add_ons.currency.sb_pos?e=_easybook_add_ons.currency.symbol+" "+e:"right_space"==_easybook_add_ons.currency.sb_pos?e+=" "+_easybook_add_ons.currency.symbol:e+=_easybook_add_ons.currency.symbol)}else t&&(e=_easybook_add_ons.currency.symbol+e);return e}function ie(e){return e=parseFloat(e),isNaN(e)&&(e=0),e}function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function se(e,t,n){return(t=de(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ue(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,de(a.key),a)}}function de(e){var t=function(e,t){if("object"!=ce(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=ce(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(e);return"symbol"==ce(t)?t:String(t)}function pe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(pe=function(){return!!e})()}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function me(e,t){return(me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ye=ReactRedux.connect,ve=function(e){function l(e){var t,n,a,r;!function(e,t){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this),n=this,r=[e],a=fe(a=l),t=function(e,t){if(t&&("object"===ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return he(e)}(n,pe()?Reflect.construct(a,r||[],fe(n).constructor):a.apply(n,r));var o=null!=e.min_nights?e.min_nights:1,i=re(),c=re(null,o);return t.format="YYYY-MM-DD",t.bktype="rooms_old",t.price_based="per_night",t.min_nights=o,null!=t.props.format&&""!=t.props.format&&(t.format=t.props.format),null!=t.props.bktype&&""!=t.props.bktype&&(t.bktype=t.props.bktype),null!=t.props.price_based&&""!=t.props.price_based&&(t.price_based=t.props.price_based),t.state={adults:1,children:0,checkin:i,checkout:c,selected:[],selected_services:[],booked:[],bookable:!1,checkavailable:!0,checkingavai:!1,submit:!1},t.formRef=null,t.setFormRef=t.setFormRef.bind(he(t)),t.checkAvailability=t.checkAvailability.bind(he(t)),t.onSelectRoom=t.onSelectRoom.bind(he(t)),t.getCheckInOut=t.getCheckInOut.bind(he(t)),t.onChange=t.onChange.bind(he(t)),t.onClickQtt=t.onClickQtt.bind(he(t)),t.onChangeRoomQtt=t.onChangeRoomQtt.bind(he(t)),t.onSubmit=t.onSubmit.bind(he(t)),t.onClickSubmit=t.onClickSubmit.bind(he(t)),t.handleChange=t.handleChange.bind(he(t)),t.handleClick=t.handleClick.bind(he(t)),t.handleAvaiCalEvent=t.handleAvaiCalEvent.bind(he(t)),t}var t,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&me(e,t)}(l,React.Component),n=[{key:"getDerivedStateFromProps",value:function(e,t){return e.booking.checkingavai!==t.checkingavai?{booked:[],checkingavai:!1}:null}}],ue((t=l).prototype,[{key:"componentDidMount",value:function(){window.addEventListener("availability_dates_selected",this.handleAvaiCalEvent,!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("availability_dates_selected",this.handleAvaiCalEvent,!0)}},{key:"handleAvaiCalEvent",value:function(e){if(null!=e.detail){var t=e.detail,n=t.vals;t.metas,null!=n&&Array.isArray(n)&&2==n.length&&this.setState({checkin:this._formatOutDate(n[0]),checkout:this._formatOutDate(n[1]),checkavailable:!0,booked:[],bookable:!1})}}},{key:"_formatOutDate",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"20181216",t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n="",a="",r="";return null!=e&&8==e.length?(n=e.substr(0,4),a=e.substr(4,2),r=e.substr(6,2),1==t?"".concat(n,"-").concat(a,"-").concat(r):this.format.replace("YYYY",n).replace("MM",a).replace("DD",r)):""}},{key:"_renderCusHtml",value:function(){var e=document.getElementById("tmpl-custom-get-field").innerHTML;return""!=e&&React.createElement("div",{className:"cus-field-bk-content",dangerouslySetInnerHTML:{__html:e}})}},{key:"setFormRef",value:function(e){this.formRef=e}},{key:"checkAvailability",value:function(e){this.setState({bookable:!1,checkavailable:!1,checkingavai:!0}),this.props.checkAvailability(this.state)}},{key:"onChange",value:function(e,t){this.setState(se(se({},t,e.target.value),"checkavailable",!0))}},{key:"handleChange",value:function(t,e){var n=e.target.value,a=this.state.selected_services,r=a.findIndex(function(e){return e.id==t});-1!==r?a.splice(r,1):a.push({id:t,price:n,qtt:1}),this.setState({selected_services:a})}},{key:"handleClick",value:function(){this.setState(function(e){return{isToggleOn:!e.isToggleOn}})}},{key:"getCheckInOut",value:function(e){Array.isArray(e)&&2==e.length&&this.setState({checkin:e[0],checkout:e[1],checkavailable:!0})}},{key:"onClickQtt",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"up",t=1<arguments.length?arguments[1]:void 0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1e3,r=this.state[t];"down"==e&&n<r?--r:"up"==e&&r<a&&++r,this.setState(se(se({},t,r),"checkavailable",!0))}},{key:"onChangeRoomQtt",value:function(e,t,n){var a=this.state,r=a.booked,o=a.bookable;if(Array.isArray(r)){var i=r.findIndex(function(e){return e.id==t}),c=n.min_adults;(null==c||c<0)&&(c=1),-1!==i?0<e&&c<=e?r[i]={id:t,qtt:e}:r.splice(i,1):0<e&&c<=e&&r.push({id:t,qtt:e}),o=0<r.length}this.setState({booked:r,bookable:o})}},{key:"onSelectRoom",value:function(e){var t,n=e.target.value,a=this.state.selected;-1===a.indexOf(n)&&this.setState({selected:[].concat((t=a,function(e){if(Array.isArray(e))return le(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return le(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(e,void 0):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[n])})}},{key:"onClickSubmit",value:function(e){this.setState({submit:!0,bookable:!1,checkavailable:!1})}},{key:"onSubmit",value:function(e){this.state.submit||e.preventDefault()}},{key:"componentDidUpdate",value:function(e,t){this.state.submit&&this.formRef.submit()}},{key:"_getDatesDiff",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.state,n=t.checkin,a=t.checkout,r=0;if(""!=n&&""!=a){var o=new Date(n),i=new Date(a);r=Math.floor((i-o)/864e5),1==e&&++r}return r}},{key:"render",value:function(){var i=this,e=this.props.booking,l=e.rooms,t=e.available,n=e.services,a=this.state,c=a.booked,s=(a.selected,a.submit),r=a.bookable,o=a.checkavailable,u=a.checkingavai,d=a.selected_services,p=a.checkin,f=a.checkout,h=[],m=0,y=1;null!=l&&l.length&&(Array.isArray(t)&&t.length&&t.forEach(function(t,e){if(0<parseInt(t.quantities)){var n=l.find(function(e){return e.id==t.id}),a=c.find(function(e){return e.id==t.id}),r=0;null!=a&&(r=a.qtt);var o=Object.assign({},n);o=Object.assign(o,t,{available:!0,qtt:r}),h.push(React.createElement(Q,{rOrder:y,key:e,room:o,changeRoomQtt:i.onChangeRoomQtt})),y++}}),0==h.length&&(h=React.createElement("div",null,"There is no available rooms. Please try with different days.")));var v=[];null!=n&&n.length&&n.forEach(function(t,e){var n=d.findIndex(function(e){return e.id==t.service_id});v.push(React.createElement("div",{key:e,className:"cth-dropdown-item lserv-dropdown"},React.createElement("input",{name:t.service_id,onChange:function(e){return i.handleChange(t.service_id,e)},type:"checkbox",value:t.service_price,defaultChecked:-1!==n,id:t.service_id}),React.createElement("label",{htmlFor:t.service_id},t.service_name,React.createElement("span",{className:"cth-dropdown-meta"},oe(t.service_price)))))});var b=[];return Array.isArray(c)&&c.length&&(c.forEach(function(t,e){var n=l.find(function(e){return e.id==t.id}),a=n.price,r=n.dPrices,o=ie(a);for(var i in r)if(r[i].iso!=f){var c=ie(r[i].price);0<c?(m+=c*t.qtt,s&&b.push(React.createElement("input",{key:"price_".concat(i,"_").concat(t.id),type:"hidden",name:"rooms_old[".concat(t.id,"][").concat(r[i].iso,"]"),value:c,readOnly:!0}))):(m+=o*t.qtt,s&&b.push(React.createElement("input",{key:"price_".concat(i,"_").concat(t.id),type:"hidden",name:"rooms_old[".concat(t.id,"][").concat(r[i].iso,"]"),value:o,readOnly:!0})))}s&&b.push(React.createElement("input",{key:"qtt_".concat(e),type:"hidden",name:"rooms_old[".concat(t.id,"][qtt]"),value:t.qtt,readOnly:!0}))}),s&&(d.forEach(function(e,t){var n="addservices[".concat(t,"]");b.push(React.createElement("input",{key:"addservices_".concat(t),type:"hidden",name:n,value:e.id,readOnly:!0}))}),b.push(React.createElement("input",{key:"product_id",type:"hidden",name:"product_id",value:_easybook_add_ons.post_id,readOnly:!0})),b.push(React.createElement("input",{key:"esb_add_to_cart",type:"hidden",name:"action",value:"esb_add_to_cart",readOnly:!0})),b.push(React.createElement("input",{key:"booking_type",type:"hidden",name:"booking_type",value:this.bktype,readOnly:!0})),b.push(React.createElement("input",{key:"price_based",type:"hidden",name:"price_based",value:this.price_based,readOnly:!0}))),null!=d&&d.length&&d.forEach(function(e,t){m+=parseFloat(e.price)*parseFloat(e.qtt)})),React.createElement("form",{method:"post",className:"book-formsss custom-formsss",onSubmit:this.onSubmit,ref:this.setFormRef},React.createElement("fieldset",null,React.createElement("div",{className:"cal-item checkin-out-inputs"},React.createElement(J,{fieldName:"checkinout",fieldValue:[p,f],field:{label:_easybook_add_ons.i18n.book_dates,icon:"fal fa-calendar-check",format:this.format},getCheckInOut:this.getCheckInOut,min_nights:this.min_nights}),React.createElement("input",{type:"hidden",name:"checkout",value:f,readOnly:!0}),React.createElement("input",{type:"hidden",name:"checkin",value:p,readOnly:!0})),React.createElement("div",{className:"cal-item guests-inputs"},React.createElement("div",{className:"qtt-item fl-wrap adults-qtt"},React.createElement("label",{className:"qtt-label"},_easybook_add_ons.i18n.book_ad),React.createElement("div",{className:"qtt-input"},React.createElement("input",{type:"number",name:"adults",min:"1",max:"10",step:"1",value:this.state.adults,onChange:function(e){return i.onChange(e,"adults")}}),React.createElement("div",{className:"qtt-nav"},React.createElement("div",{className:"qtt-btn qtt-up",onClick:function(e){return i.onClickQtt("up","adults",1,10)}},"+"),React.createElement("div",{className:"qtt-btn qtt-down",onClick:function(e){return i.onClickQtt("down","adults",1,10)}},"-")))),React.createElement("div",{className:"qtt-item fl-wrap children-qtt"},React.createElement("label",{className:"qtt-label"},_easybook_add_ons.i18n.book_chi),React.createElement("div",{className:"qtt-input"},React.createElement("input",{type:"number",name:"children",min:"0",max:"10",step:"1",value:this.state.children,onChange:function(e){return i.onChange(e,"children")}}),React.createElement("div",{className:"qtt-nav"},React.createElement("div",{className:"qtt-btn qtt-up",onClick:function(e){return i.onClickQtt("up","children",0,10)}},"+"),React.createElement("div",{className:"qtt-btn qtt-down",onClick:function(e){return i.onClickQtt("down","children",0,10)}},"-"))))),u?React.createElement(ae,null):0<h.length&&React.createElement("div",{className:"cal-item available-rooms-services"},React.createElement("div",{className:"available-rooms"},React.createElement("label",null,_easybook_add_ons.i18n.book_avr),React.createElement("div",{className:"fl-wrap multiqtts-select-wrap rooms-items-wrap"},h)),0<n.length&&React.createElement("div",{className:"cth-dropdown-warp services-wrap"},React.createElement("div",{className:"cth-dropdown-header",onClick:this.handleClick},React.createElement("label",null,_easybook_add_ons.i18n.book_services,React.createElement("span",{className:"count-select-ser"},d.length))),this.state.isToggleOn?React.createElement("div",{className:"cth-dropdown-options"},React.createElement("div",{className:"cth-dropdown-inner"},v)):null)),React.createElement("div",{className:"total-coast fl-wrap clearfix"},React.createElement("strong",null,_easybook_add_ons.i18n.book_ts),React.createElement("span",null,oe(m))),React.createElement("div",{className:"booking-buttons"},React.createElement("button",{type:"button",onClick:this.checkAvailability,className:"btn-check-availability",disabled:!o},_easybook_add_ons.i18n.book_chev),React.createElement("button",{type:"button",onClick:this.onClickSubmit,className:"btn-book-now",disabled:!r},_easybook_add_ons.i18n.book_bn))),b)}}]),ue(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(),be=ye(function(e){return{booking:e.booking}},function(t){return{checkAvailability:function(e){return t(T(e))}}})(ve);function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ge=function(){return!!e})()}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e,t){return(Ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var we=function(e){function c(e){var t;!function(e,t){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this);var n,a,r,o=(n=this,a=c,r=[e],a=ke(a),t=function(e,t){if(t&&("object"===_e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Re(e)}(n,ge()?Reflect.construct(a,r||[],ke(n).constructor):a.apply(n,r))).props.room;t.state={qtt:o.qtt,adults:0,children:0,infant:0};var i=5;return parseInt(o.quantities)<i&&(i=parseInt(o.quantities)),t.max_qtt=i,t.onChangeQtt=t.onChangeQtt.bind(Re(t)),t.onClickQtt=t.onClickQtt.bind(Re(t)),t}var t;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ee(e,t)}(c,React.Component),function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,"symbol"==_e(o=function(e,t){if("object"!=_e(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=_e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(r))?o:String(o)),a)}var r,o}((t=c).prototype,[{key:"onChangeQtt",value:function(e,t){this.handleQttChange(t,e.target.value)}},{key:"handleQttChange",value:function(e,t){var n=this.props.room,a=n.id,r=n.available,o=this.state;0<=t&&(o[e]=t,this.setState(o),r&&this.props.changePersonQtt(o,a,this.props.room))}},{key:"onClickQtt",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"up",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1e3,r=0;null!=this.state[e]&&(r=this.state[e]),"down"==t&&n<r?--r:"up"==t&&r<a&&++r,this.handleQttChange(e,r)}},{key:"render",value:function(){var t=this,e=this.props.room,n=(e.id,e.adults),a=e.children,r=e.title,o=(e.quantities,e.available),i=e.price,c=e.children_price,l=this.props.rOrder,s=parseInt(n)+parseInt(a);return React.createElement("div",{className:"multiqtts-select_item bkroom_new-item"},React.createElement("div",{className:null!=l&&1===l?"multiqtts-select_header vis-multiqtt_select fl-wrap":"multiqtts-select_header fl-wrap"},r,React.createElement("span",{className:"available_counter green-bg"},s),React.createElement("i",{className:"fal fa-plus"})),o&&React.createElement("div",{className:null!=l&&1===l?"custom-tour-quantities multiqtts-select_content vis-multiqtt_select_cont":"custom-tour-quantities multiqtts-select_content"},React.createElement("div",{className:"qtt-item qtt-item-full"},React.createElement("div",{className:"qtt-label-wrap"},_easybook_add_ons.i18n.adults),React.createElement("div",{className:"qtt-price text-right"},oe(i)," x "),React.createElement("div",{className:"qtt-input"},React.createElement("input",{type:"number",className:"tour-quantity-input",min:"0",step:"1",max:parseInt(n),value:this.state.adults,readOnly:!0,onChange:function(e){return t.onChangeQtt(e,"adults")}}),React.createElement("div",{className:"qtt-nav"},React.createElement("div",{className:"qtt-btn qtt-up",onClick:function(e){return t.onClickQtt("adults","up",0,parseInt(n))}},"+"),React.createElement("div",{className:"qtt-btn qtt-down",onClick:function(e){return t.onClickQtt("adults","down",0,parseInt(n))}},"-")))),React.createElement("div",{className:"qtt-item qtt-item-full mt-10"},React.createElement("div",{className:"qtt-label-wrap"},_easybook_add_ons.i18n.children),React.createElement("div",{className:"qtt-price text-right"},oe(c)," x "),React.createElement("div",{className:"qtt-input"},React.createElement("input",{type:"number",className:"tour-quantity-input",min:"0",step:"1",max:parseInt(a),value:this.state.children,readOnly:!0,onChange:function(e){return t.onChangeQtt(e,"children")}}),React.createElement("div",{className:"qtt-nav"},React.createElement("div",{className:"qtt-btn qtt-up",onClick:function(e){return t.onClickQtt("children","up",0,parseInt(a))}},"+"),React.createElement("div",{className:"qtt-btn qtt-down",onClick:function(e){return t.onClickQtt("children","down",0,parseInt(a))}},"-"))))))}}]),Object.defineProperty(t,"prototype",{writable:!1}),c}();function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Se(e,t,n){return(t=je(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ne(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,je(a.key),a)}}function je(e){var t=function(e,t){if("object"!=Oe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=Oe(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(e);return"symbol"==Oe(t)?t:String(t)}function De(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(De=function(){return!!e})()}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e,t){return(Te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Ae=ReactRedux.connect,Ie=function(e){function l(e){var t,n,a,r;!function(e,t){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this),n=this,r=[e],a=qe(a=l),t=function(e,t){if(t&&("object"===Oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Pe(e)}(n,De()?Reflect.construct(a,r||[],qe(n).constructor):a.apply(n,r));var o=null!=e.min_nights?e.min_nights:1,i=re(),c=re(null,o);return t.format="YYYY-MM-DD",t.bktype="rooms",t.price_based="per_night",t.min_nights=o,null!=t.props.format&&""!=t.props.format&&(t.format=t.props.format),null!=t.props.bktype&&""!=t.props.bktype&&(t.bktype=t.props.bktype),null!=t.props.price_based&&""!=t.props.price_based&&(t.price_based=t.props.price_based),t.state={adults:1,children:0,checkin:i,checkout:c,selected:[],selected_services:[],booked:[],bookable:!1,checkavailable:!0,checkingavai:!1,submit:!1},t.formRef=null,t.setFormRef=t.setFormRef.bind(Pe(t)),t.checkAvailability=t.checkAvailability.bind(Pe(t)),t.onSelectRoom=t.onSelectRoom.bind(Pe(t)),t.getCheckInOut=t.getCheckInOut.bind(Pe(t)),t.onChange=t.onChange.bind(Pe(t)),t.onClickQtt=t.onClickQtt.bind(Pe(t)),t.onChangeRoomQtt=t.onChangeRoomQtt.bind(Pe(t)),t.onSubmit=t.onSubmit.bind(Pe(t)),t.onClickSubmit=t.onClickSubmit.bind(Pe(t)),t.handleChange=t.handleChange.bind(Pe(t)),t.handleClick=t.handleClick.bind(Pe(t)),t.handleAvaiCalEvent=t.handleAvaiCalEvent.bind(Pe(t)),t.onchangePersonQtt=t.onchangePersonQtt.bind(Pe(t)),t}var t,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Te(e,t)}(l,React.Component),n=[{key:"getDerivedStateFromProps",value:function(e,t){return e.booking.checkingavai!==t.checkingavai?{booked:[],checkingavai:!1}:null}}],Ne((t=l).prototype,[{key:"componentDidMount",value:function(){window.addEventListener("availability_dates_selected",this.handleAvaiCalEvent,!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("availability_dates_selected",this.handleAvaiCalEvent,!0)}},{key:"handleAvaiCalEvent",value:function(e){if(null!=e.detail){var t=e.detail,n=t.vals;t.metas,null!=n&&Array.isArray(n)&&2==n.length&&this.setState({checkin:this._formatOutDate(n[0]),checkout:this._formatOutDate(n[1]),checkavailable:!0,booked:[],bookable:!1})}}},{key:"_formatOutDate",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"20181216",t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n="",a="",r="";return null!=e&&8==e.length?(n=e.substr(0,4),a=e.substr(4,2),r=e.substr(6,2),1==t?"".concat(n,"-").concat(a,"-").concat(r):this.format.replace("YYYY",n).replace("MM",a).replace("DD",r)):""}},{key:"_renderCusHtml",value:function(){var e=document.getElementById("tmpl-custom-get-field").innerHTML;return""!=e&&React.createElement("div",{className:"cus-field-bk-content",dangerouslySetInnerHTML:{__html:e}})}},{key:"setFormRef",value:function(e){this.formRef=e}},{key:"checkAvailability",value:function(e){this.setState({bookable:!1,checkavailable:!1,checkingavai:!0}),this.props.checkAvailability(this.state)}},{key:"onChange",value:function(e,t){this.setState(Se(Se({},t,e.target.value),"checkavailable",!0))}},{key:"handleChange",value:function(t,e){var n=e.target.value,a=this.state.selected_services,r=a.findIndex(function(e){return e.id==t});-1!==r?a.splice(r,1):a.push({id:t,price:n,qtt:1}),this.setState({selected_services:a})}},{key:"handleClick",value:function(){this.setState(function(e){return{isToggleOn:!e.isToggleOn}})}},{key:"getCheckInOut",value:function(e){Array.isArray(e)&&2==e.length&&this.setState({checkin:e[0],checkout:e[1],checkavailable:!0})}},{key:"onClickQtt",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"up",t=1<arguments.length?arguments[1]:void 0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1e3,r=this.state[t];"down"==e&&n<r?--r:"up"==e&&r<a&&++r,this.setState(Se(Se({},t,r),"checkavailable",!0))}},{key:"onChangeRoomQtt",value:function(e,t,n){var a=this.state,r=a.booked,o=a.bookable;if(Array.isArray(r)){var i=r.findIndex(function(e){return e.id==t}),c=n.min_adults;(null==c||c<0)&&(c=1),-1!==i?0<e&&c<=e?r[i]={id:t,qtt:e}:r.splice(i,1):0<e&&c<=e&&r.push({id:t,qtt:e}),o=0<r.length}this.setState({booked:r,bookable:o})}},{key:"onchangePersonQtt",value:function(e,t,n){var a=this.state,r=a.booked,o=a.bookable;if(Array.isArray(r)){var i=r.findIndex(function(e){return e.id==t}),c=e.qtt,l=e.adults,s=e.children,u=e.infant,d=n.min_adults;(null==d||d<0)&&(d=1),-1!==i?0<l+s+u&&d<=l?r[i]={id:t,qtt:c,adults:l,children:s,infant:u}:r.splice(i,1):0<l+s+u&&d<=l&&r.push({id:t,qtt:c,adults:l,children:s,infant:u}),o=0<r.length}this.setState({booked:r,bookable:o})}},{key:"onSelectRoom",value:function(e){var t,n=e.target.value,a=this.state.selected;-1===a.indexOf(n)&&this.setState({selected:[].concat((t=a,function(e){if(Array.isArray(e))return Ce(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Ce(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ce(e,void 0):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[n])})}},{key:"onClickSubmit",value:function(e){this.setState({submit:!0,bookable:!1,checkavailable:!1})}},{key:"onSubmit",value:function(e){this.state.submit||e.preventDefault()}},{key:"componentDidUpdate",value:function(e,t){this.state.submit&&this.formRef.submit()}},{key:"_getDatesDiff",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.state,n=t.checkin,a=t.checkout,r=0;if(""!=n&&""!=a){var o=new Date(n),i=new Date(a);r=Math.floor((i-o)/864e5),1==e&&++r}return r}},{key:"render",value:function(){var i=this,c=this,e=this.props.booking,h=e.rooms,t=e.available,n=e.services,a=this.state,l=a.booked,m=(a.selected,a.submit),r=a.bookable,o=a.checkavailable,s=a.checkingavai,u=a.selected_services,d=a.checkin,y=a.checkout,p=[],v=0,f=1;null!=h&&h.length&&(Array.isArray(t)&&t.length&&t.forEach(function(t,e){if(0<parseInt(t.quantities)){var n=h.find(function(e){return e.id==t.id}),a=l.find(function(e){return e.id==t.id}),r=0;null!=a&&(r=a.qtt);var o=Object.assign({},n);o=Object.assign(o,t,{available:!0,qtt:r}),"per_night"===c.price_based?p.push(React.createElement(Q,{rOrder:f,key:e,room:o,changeRoomQtt:i.onChangeRoomQtt})):p.push(React.createElement(we,{rOrder:f,key:e,room:o,changePersonQtt:i.onchangePersonQtt})),f++}}),0==p.length&&(p=React.createElement("div",null,"There is no available rooms. Please try with different days.")));var b=[];null!=n&&n.length&&n.forEach(function(t,e){var n=u.findIndex(function(e){return e.id==t.service_id});b.push(React.createElement("div",{key:e,className:"cth-dropdown-item lserv-dropdown"},React.createElement("input",{name:t.service_id,onChange:function(e){return i.handleChange(t.service_id,e)},type:"checkbox",value:t.service_price,defaultChecked:-1!==n,id:t.service_id}),React.createElement("label",{htmlFor:t.service_id},t.service_name,React.createElement("span",{className:"cth-dropdown-meta"},oe(t.service_price)))))});var _=[];return Array.isArray(l)&&l.length&&(l.forEach(function(t,e){var n=h.find(function(e){return e.id==t.id}),a=n.price,r=n.children_price,o=n.infant_price,i=n.dPrices,c=ie(a),l=ie(r),s=ie(o);for(var u in i)if(i[u].iso!=y){var d=ie(i[u].price),p=ie(i[u].children_price),f=ie(i[u].infant_price);0<d?(v+=d*t.adults,m&&_.push(React.createElement("input",{key:"adults_".concat(u,"_").concat(t.id),type:"hidden",name:"rooms_new[".concat(t.id,"][").concat(i[u].iso,"][adults]"),value:d,readOnly:!0}))):(v+=c*t.adults,m&&_.push(React.createElement("input",{key:"adults_".concat(u,"_").concat(t.id),type:"hidden",name:"rooms_new[".concat(t.id,"][").concat(i[u].iso,"][adults]"),value:c,readOnly:!0}))),0<p?(v+=p*t.children,m&&_.push(React.createElement("input",{key:"children_".concat(u,"_").concat(t.id),type:"hidden",name:"rooms_new[".concat(t.id,"][").concat(i[u].iso,"][children]"),value:p,readOnly:!0}))):(v+=l*t.children,m&&_.push(React.createElement("input",{key:"children_".concat(u,"_").concat(t.id),type:"hidden",name:"rooms_new[".concat(t.id,"][").concat(i[u].iso,"][children]"),value:l,readOnly:!0}))),0<f?(v+=f*t.infant,m&&_.push(React.createElement("input",{key:"infant_".concat(u,"_").concat(t.id),type:"hidden",name:"rooms_new[".concat(t.id,"][").concat(i[u].iso,"][infant]"),value:f,readOnly:!0}))):(v+=s*t.infant,m&&_.push(React.createElement("input",{key:"infant_".concat(u,"_").concat(t.id),type:"hidden",name:"rooms_new[".concat(t.id,"][").concat(i[u].iso,"][infant]"),value:s,readOnly:!0})))}m&&(_.push(React.createElement("input",{key:"adults_".concat(e),type:"hidden",name:"rooms_new[".concat(t.id,"][adults]"),value:t.adults,readOnly:!0})),_.push(React.createElement("input",{key:"children_".concat(e),type:"hidden",name:"rooms_new[".concat(t.id,"][children]"),value:t.children,readOnly:!0})),_.push(React.createElement("input",{key:"infant_".concat(e),type:"hidden",name:"rooms_new[".concat(t.id,"][infant]"),value:t.infant,readOnly:!0})))}),m&&(u.forEach(function(e,t){var n="addservices[".concat(t,"]");_.push(React.createElement("input",{key:"addservices_".concat(t),type:"hidden",name:n,value:e.id,readOnly:!0}))}),_.push(React.createElement("input",{key:"product_id",type:"hidden",name:"product_id",value:_easybook_add_ons.post_id,readOnly:!0})),_.push(React.createElement("input",{key:"esb_add_to_cart",type:"hidden",name:"action",value:"esb_add_to_cart",readOnly:!0})),_.push(React.createElement("input",{key:"booking_type",type:"hidden",name:"booking_type",value:c.bktype,readOnly:!0})),_.push(React.createElement("input",{key:"price_based",type:"hidden",name:"price_based",value:c.price_based,readOnly:!0}))),null!=u&&u.length&&u.forEach(function(e,t){v+=parseFloat(e.price)*parseFloat(e.qtt)})),React.createElement("form",{method:"post",className:"book-formsss custom-formsss",onSubmit:this.onSubmit,ref:this.setFormRef},React.createElement("fieldset",null,React.createElement("div",{className:"cal-item checkin-out-inputs"},React.createElement(J,{fieldName:"checkinout",fieldValue:[d,y],field:{label:_easybook_add_ons.i18n.book_dates,icon:"fal fa-calendar-check",format:this.format},getCheckInOut:this.getCheckInOut,min_nights:c.min_nights}),React.createElement("input",{type:"hidden",name:"checkout",value:y,readOnly:!0}),React.createElement("input",{type:"hidden",name:"checkin",value:d,readOnly:!0})),"per_night"===this.price_based&&React.createElement("div",{className:"cal-item guests-inputs"},React.createElement("div",{className:"qtt-item fl-wrap adults-qtt"},React.createElement("label",{className:"qtt-label"},_easybook_add_ons.i18n.book_ad),React.createElement("div",{className:"qtt-input"},React.createElement("input",{type:"number",name:"adults",min:"1",max:"10",step:"1",value:this.state.adults,onChange:function(e){return i.onChange(e,"adults")}}),React.createElement("div",{className:"qtt-nav"},React.createElement("div",{className:"qtt-btn qtt-up",onClick:function(e){return i.onClickQtt("up","adults",1,10)}},"+"),React.createElement("div",{className:"qtt-btn qtt-down",onClick:function(e){return i.onClickQtt("down","adults",1,10)}},"-")))),React.createElement("div",{className:"qtt-item fl-wrap children-qtt"},React.createElement("label",{className:"qtt-label"},_easybook_add_ons.i18n.book_chi),React.createElement("div",{className:"qtt-input"},React.createElement("input",{type:"number",name:"children",min:"0",max:"10",step:"1",value:this.state.children,onChange:function(e){return i.onChange(e,"children")}}),React.createElement("div",{className:"qtt-nav"},React.createElement("div",{className:"qtt-btn qtt-up",onClick:function(e){return i.onClickQtt("up","children",0,10)}},"+"),React.createElement("div",{className:"qtt-btn qtt-down",onClick:function(e){return i.onClickQtt("down","children",0,10)}},"-"))))),s?React.createElement(ae,null):0<p.length&&React.createElement("div",{className:"cal-item available-rooms-services"},React.createElement("div",{className:"available-rooms"},React.createElement("label",null,_easybook_add_ons.i18n.book_avr),React.createElement("div",{className:"fl-wrap multiqtts-select-wrap rooms-items-wrap"},p)),0<n.length&&React.createElement("div",{className:"cth-dropdown-warp services-wrap"},React.createElement("div",{className:"cth-dropdown-header",onClick:this.handleClick},React.createElement("label",null,_easybook_add_ons.i18n.book_services,React.createElement("span",{className:"count-select-ser"},u.length))),this.state.isToggleOn?React.createElement("div",{className:"cth-dropdown-options"},React.createElement("div",{className:"cth-dropdown-inner"},b)):null)),React.createElement("div",{className:"total-coast fl-wrap clearfix"},React.createElement("strong",null,_easybook_add_ons.i18n.book_ts),React.createElement("span",null,oe(v))),React.createElement("div",{className:"booking-buttons"},React.createElement("button",{type:"button",onClick:this.checkAvailability,className:"btn-check-availability",disabled:!o},_easybook_add_ons.i18n.book_chev),React.createElement("button",{type:"button",onClick:this.onClickSubmit,className:"btn-book-now",disabled:!r},_easybook_add_ons.i18n.book_bn))),_)}}]),Ne(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(),xe=Ae(function(e){return{booking:e.booking}},function(t){return{checkAvailability:function(e){return t(T(e))}}})(Ie),Me={profile:{},chats:{contacts:[],replies:[],firstLoaded:!1,active:0,touid:0,fuid:0,firstRemain:!0,firstRID:0,lastRID:0,noReplyNum:0},sidebar:{listings:_easybook_dashboard.update_status.count_listings,bookings:0,reviews:_easybook_dashboard.update_status.comments},listings:{posts:[],pagi:{pages:1,paged:1}},reviews:{comments:[],pagi:{pages:1,paged:1}},bookings:{posts:[],pagi:{pages:1,paged:1}},changpass:{success:!1},content:{},dashboard:{notifications:[],statistics:[]},listingType:"",listing:{fields:[],rFields:[],post:{},rooms:[],coupons:[],isAdding:!1,isEditing:!1},redirect:{status:!1,url:""},withdrawals:{posts:[],pagi:{pages:1,paged:1},earning:0},messages:[],invoices:{posts:[],pagi:{pages:1,paged:1},postid:{}},invoice:{},chart:[],earnings:{posts:[],pagi:{pages:1,paged:1}},adcampaigns:{posts:[],pagi:{pages:1,paged:1}}};function Fe(e){return function(e){if(Array.isArray(e))return Qe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Qe(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qe(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Be=(0,Redux.combineReducers)({chats:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Me.chats,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case b:var n={contacts:t.chat.contacts,replies:t.chat.replies,active:t.chat.active,touid:t.chat.touid,fuid:t.chat.fuid};return 0==e.firstLoaded&&(n.firstLoaded=!0),Object.assign({},e,n);case _:if(0!=t.lastRID)return 0==t.replies.length?Object.assign({},e,{noReplyNum:e.noReplyNum+1}):Object.assign({},e,{noReplyNum:0,replies:[].concat(Fe(e.replies),Fe(t.replies))});var a={replies:t.replies,noReplyNum:0};return t.replies.length?(a.firstRemain=!0,a.firstRID=t.replies[0].crid,a.lastRID=t.replies[t.replies.length-1].crid):(a.firstRemain=!1,a.firstRID=0,a.lastRID=0),Object.assign({},e,a);case g:var r={replies:[].concat(Fe(t.replies),Fe(e.replies))};return t.replies.length||(r.firstRemain=!1),Object.assign({},e,r);case k:return Object.assign({},e,{active:t.contact.cid,touid:t.contact.touid,fuid:t.contact.user_one});case R:return Object.assign({},e,{replies:[].concat(Fe(e.replies),[t.reply])});case E:return Object.assign({},e,{firstRID:t.firstRID,lastRID:t.lastRID});case w:return Me.chats;case"NEW_CONTACT":return[].concat(Fe(e),[t.contact]);default:return e}}}),Le={booking:{rooms:[],available:[],services:[],checkingavai:!1}},Ye=(0,Redux.combineReducers)({booking:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Le.booking,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case q:return Object.assign({},e,{checkingavai:!0});case P:return Object.assign({},e,{rooms:t.data.rooms,available:t.data.available,services:t.data.add_services,checkingavai:!1});default:return e}}});function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ue=function(){return!!e})()}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function We(e,t){return(We=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var $e=ReactRedux.Provider,Ge=Redux,Ke=Ge.createStore,Je=Ge.applyMiddleware,Ze=Ke(Be,Je(ReduxThunk.default)),ze=Ke(Ye,Je(ReduxThunk.default)),Xe=function(e){function a(){return function(e,t){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),e=this,n=arguments,t=Ve(t=a),function(e,t){if(t&&("object"===He(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ue()?Reflect.construct(t,n||[],Ve(e).constructor):t.apply(e,n));var e,t,n}var t;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&We(e,t)}(a,React.Component),function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,"symbol"==He(o=function(e,t){if("object"!=He(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return String(e);var a=n.call(e,"string");if("object"!=He(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(r))?o:String(o)),a)}var r,o}((t=a).prototype,[{key:"render",value:function(){return React.createElement(D,null)}}]),Object.defineProperty(t,"prototype",{writable:!1}),a}(),et=document.querySelector("#chat-app");null!=et&&ReactDOM.render(React.createElement($e,{store:Ze},React.createElement(Xe,null)),et);var tt=document.querySelector("#bookingform-app");if(null!=tt){var nt="",at=1;tt.hasAttribute("data-format")&&(nt=tt.getAttribute("data-format")),tt.hasAttribute("min_nights")&&(at=tt.getAttribute("min_nights")),ReactDOM.render(React.createElement($e,{store:ze},React.createElement(be,{format:nt,min_nights:at})),tt)}var rt=document.getElementById("bookingrooms-app");if(null!=rt){var ot="",it="per_night",ct=1;rt.hasAttribute("data-format")&&(ot=rt.getAttribute("data-format")),rt.hasAttribute("price_based")&&(it=rt.getAttribute("price_based")),rt.hasAttribute("min_nights")&&(ct=rt.getAttribute("min_nights")),ReactDOM.render(React.createElement($e,{store:ze},React.createElement(xe,{format:ot,price_based:it,bktype:"rooms_new",min_nights:ct})),rt)}}();